Basically this concept developed by Rounk.

I convert whole code into objective-c.
